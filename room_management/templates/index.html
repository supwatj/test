{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-speedometer2"></i> Dashboard</h2>
    <a href="{{ url_for('check_in') }}" class="btn btn-primary">
        <i class="bi bi-box-arrow-in-right"></i> New Check-in
    </a>
</div>

<!-- Stats Cards -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card stat-card">
            <div class="card-body text-center">
                <h3 class="display-4">{{ total_rooms }}</h3>
                <p class="mb-0">Total Rooms</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card stat-card success">
            <div class="card-body text-center">
                <h3 class="display-4">{{ vacant_rooms }}</h3>
                <p class="mb-0">Vacant Rooms</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card stat-card danger">
            <div class="card-body text-center">
                <h3 class="display-4">{{ occupied_rooms }}</h3>
                <p class="mb-0">Occupied Rooms</p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col-md-3">
        <a href="{{ url_for('check_in') }}" class="card text-decoration-none h-100">
            <div class="card-body text-center py-4">
                <i class="bi bi-box-arrow-in-right fs-1 text-primary"></i>
                <h5 class="mt-2">Check-in</h5>
                <small class="text-muted">Register a new guest</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('rooms') }}" class="card text-decoration-none h-100">
            <div class="card-body text-center py-4">
                <i class="bi bi-plus-circle fs-1 text-success"></i>
                <h5 class="mt-2">Add Room</h5>
                <small class="text-muted">Create new room</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('vacancy_report') }}" class="card text-decoration-none h-100">
            <div class="card-body text-center py-4">
                <i class="bi bi-bar-chart-line fs-1 text-warning"></i>
                <h5 class="mt-2">Vacancy Report</h5>
                <small class="text-muted">View 6-month report</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('settings') }}" class="card text-decoration-none h-100">
            <div class="card-body text-center py-4">
                <i class="bi bi-gear fs-1 text-secondary"></i>
                <h5 class="mt-2">Settings</h5>
                <small class="text-muted">Configure criteria</small>
            </div>
        </a>
    </div>
</div>

<!-- Recent Activity -->
<div class="card">
    <div class="card-header bg-white">
        <h5 class="mb-0"><i class="bi bi-clock-history"></i> Recent Activity</h5>
    </div>
    <div class="card-body">
        {% if recent_records %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Room</th>
                        <th>Type</th>
                        <th>Check-in Date</th>
                        <th>Check-out Date</th>
                        <th>Reason</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in recent_records %}
                    <tr>
                        <td>
                            <a href="{{ url_for('check_out', room_id=record.room.id) }}" class="text-decoration-none">
                                {{ record.room.room_number }}
                            </a>
                        </td>
                        <td>{{ record.room.room_type }}</td>
                        <td>{{ record.check_in_date.strftime('%Y-%m-%d') }}</td>
                        <td>
                            {% if record.check_out_date %}
                                {{ record.check_out_date.strftime('%Y-%m-%d') }}
                            {% else %}
                                <span class="badge bg-success">Checked In</span>
                            {% endif %}
                        </td>
                        <td>{{ record.reason or '-' }}</td>
                        <td>
                            {% if record.is_currently_occupied %}
                                <span class="badge bg-success">Occupied</span>
                            {% else %}
                                <span class="badge bg-secondary">Checked Out</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="text-center py-4 text-muted">
            <i class="bi bi-inbox fs-1"></i>
            <p class="mt-2">No recent activity</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
